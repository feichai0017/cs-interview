# 🧠 Coding 题目回顾
## 📚 题目描述
给定一个数组 nums 和一个大小为 k 的滑动窗口，每次移动滑动窗口一格，
求出窗口中最大值，并输出所有窗口的最大值。

## 🧠 示例
输入：

```text
nums = [1,3,-1,-3,5,3,6,7], k = 3
```
输出：

```text
[3,3,5,5,6,7]
```

# 📈 分布式缓存系统 System Design 总结

## 🔹 一、项目背景

设计一个支持高应用、高可用、多节点分布式的缓存系统，目标：

- 每秒约元 1000万请求量（10M QPS）
- 多 Region 供应
- 高时效 TTL
- 性能稳定，不允许系统整体服务不可用


## 🔹 二、系统组件设计

| 组件 | 功能 |
|:----|:-----|
| API Gateway | 分发请求，跑转缓存组织节点 |
| Cache Nodes | 分布式缓存服务，支持 TTL 、处理窗口性限流 |
| Distributed KV (etcd) | 服务发现，统一管理节点、状态 |
| Kafka (MQ) | 完成 DB binlog 发送，调用统一更新 |
| DB Agent | 从线监听数据库变化，发送到 Kafka |


## 🔹 三、主要技术设计

### 【缓存三大问题处理】

| 问题 | 解决方案 |
|:----|:----|
| 缓存穿透 | 使用 Bloom Filter 根据 Key 过滤，除非真实存在的 Key |
| 缓存击突 | 点点举案：TTL + 随机延长，点点举案：热门Key 加分布式锁 |
| 缓存雪崩 | 全缓存 TTL 随机化，防止大量同时失效 |


### 【第二层：缓存综合性能设计】

- 使用「双 TTL 策略」：
  - Soft TTL：短期限（如5-10秒），短 TTL 过期后后台开始回源
  - Hard TTL：长期限（如1-5分钟），回源失败时使用旧数据扩延服务

- 热点 Key 处理：
  - 预热缓存 Warm-up
  - 最大优先缓存剩余空间分配

- 后端 DB 保护：
  - Rate Limit 较旧 DB，设置后端强制限流，启用 Circuit Breaker 防止灰狱故障


### 【第三层：分布式数据统一】

- etcd 分布式 Raft 共识，保证缓存节点服务发现，状态统一
- DB 变更，Agent 监听 binlog，发送 Kafka，后端同步到缓存节点（最终一致）
- Master/Slave Region 分布，Master写，Slave读，避免跨地区延迟


---

# 📊 统合总结

- 从用户终到后端 DB，完成缓存打算，性能优先、高可用、分布式统一者组织
- 变更保持最终一致（Eventual Consistency），同时实现低延迟供应
- 应对极端情况（Hot Key，流量爆增），有先览性设计


【经典性很高，选择件大，能给大厂 onsite interview 直接加分】